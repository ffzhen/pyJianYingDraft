# 视频生成器GUI应用

## 功能特性

这是一个功能完整的Windows GUI应用程序，用于自动化视频生成，支持以下功能：

### 核心功能
1. **飞书数据集成** - 从飞书表格获取数据并批量生成视频
2. **手动视频生成** - 输入文案自动生成视频
3. **定时任务管理** - 支持定时触发工作流
4. **工作流管理** - 创建、管理和监控多个工作流
5. **配置管理** - 统一管理API配置和环境变量

### 技术特点
- **跨平台支持** - 基于Python tkinter，可在Windows上运行
- **多线程处理** - 后台执行任务，不阻塞GUI界面
- **数据持久化** - 配置和工作流数据本地存储
- **实时日志** - 详细的运行日志和进度显示
- **扩展性设计** - 支持添加新的工作流类型

## 系统要求

- Python 3.8+
- Windows 10/11
- 至少4GB内存
- 2GB可用磁盘空间

## 安装步骤

1. **下载并安装Python**
   - 访问 https://www.python.org/downloads/
   - 下载并安装Python 3.8或更高版本
   - 安装时请勾选"Add Python to PATH"

2. **下载本应用**
   - 解压到任意目录（建议：`C:\VideoGenerator`）

3. **运行安装脚本**
   ```bash
   双击运行 setup.bat
   ```

4. **启动应用**
   - 双击桌面上的"视频生成器"快捷方式
   - 或运行 `start_gui.bat`

## 使用指南

### 1. 配置管理

首次使用需要配置各项API信息：

- **Coze API配置**
  - Bearer Token: Coze API访问令牌
  - Workflow ID: 工作流ID

- **飞书配置**
  - App ID: 飞书应用ID
  - App Secret: 飞书应用密钥
  - Table ID: 飞书表格ID

- **火山引擎ASR配置**
  - App ID: 火山引擎应用ID
  - Access Token: 访问令牌

- **豆包API配置**
  - Token: 豆包API令牌

- **剪映配置**
  - 草稿文件夹路径: 剪映草稿保存路径

### 2. 飞书数据获取

1. 确保已正确配置飞书API信息
2. 点击"获取飞书数据"按钮
3. 系统会自动获取表格中的数据
4. 点击"批量生成视频"开始处理

### 3. 手动视频生成

1. 在"手动生成"标签页输入文案内容
2. 设置数字编号和语音ID（可选）
3. 点击"生成视频"按钮
4. 等待处理完成

### 4. 定时任务管理

1. 在"定时任务"标签页创建新任务
2. 设置任务名称、选择工作流
3. 配置执行时间和重复周期
4. 系统会自动在指定时间执行

### 5. 工作流管理

- 查看所有已创建的工作流
- 监控工作流执行状态
- 删除不需要的工作流

## 配置文件说明

### config.json
存储所有API配置信息，包含：
- Coze API配置
- 飞书API配置
- 火山引擎配置
- 豆包API配置
- 剪映路径配置

### workflows.json
存储工作流记录，包含：
- 工作流ID和名称
- 执行参数
- 执行结果
- 创建时间

### schedules.json
存储定时任务配置，包含：
- 任务名称
- 关联工作流
- 执行时间
- 重复周期

## 故障排除

### 常见问题

1. **Python未找到**
   - 确保已安装Python 3.8+
   - 检查环境变量PATH是否包含Python路径

2. **API调用失败**
   - 检查API配置是否正确
   - 确认网络连接正常
   - 验证API令牌是否有效

3. **剪映路径错误**
   - 确认剪映草稿文件夹路径正确
   - 检查文件夹权限

4. **视频生成失败**
   - 查看日志标签页了解详细错误信息
   - 检查输入的文案内容格式

### 日志查看

所有操作日志都会记录在"运行日志"标签页中，包括：
- 操作时间戳
- 执行状态
- 错误信息
- 调试信息

## 扩展开发

### 添加新的工作流类型

1. 在`VideoGeneratorGUI`类中添加新的工作流处理方法
2. 更新`run_scheduled_task`方法支持新类型
3. 在GUI中添加相应的控制界面

### 自定义API集成

1. 在配置界面添加新的配置项
2. 更新配置保存和加载逻辑
3. 实现API调用方法

## 技术支持

如遇到问题，请：
1. 查看运行日志获取错误信息
2. 检查配置文件是否正确
3. 确认网络连接正常
4. 验证API令牌有效性

## 许可证

本项目仅供学习和研究使用。

---

**注意**: 使用前请确保已获得相关API的使用权限，并遵守各平台的使用条款。